<html>

<head>
    <meta charset="UTF-8">
    <title>8. 모든 아나그램</title>
</head>

<body>
    <script>
        function compareMaps(map1, map2) {
            if (map1.size !== map2.size) return false; // 아나그램인데 Map 객체 key 갯수가 다르다? false.
            for (let [key, val] of map1) {
                if (!map2.has(key) || map2.get(key) !== val) return false;
                // 한쪽에는 있는데 다른 쪽에는 없다? false.
                // 한쪽은 a가 2개인데, 다른 한쪽은 a가 1개이다? false.
            }
            return true;
        }
        function solution(s, t) {
            let answer = 0;
            let tH = new Map();
            let sH = new Map();
            for (let x of t) {
                if (tH.has(x)) tH.set(x, tH.get(x) + 1);
                else tH.set(x, 1);
            }
            // t의 해시맵 tH 작성.

            let len = t.length - 1;
            for (let i = 0; i < len; i++) {
                if (sH.has(s[i])) sH.set(s[i], sH.get(s[i]) + 1);
                else sH.set(s[i], 1);
            }
            // sH는 t보다 한자릿수 작은 값으로 초기값 설정.

            let lt = 0;
            // lt는 0으로 시작
            for (let rt = len; rt < s.length; rt++) {
                // sH 자릿수 바로 다음부터 rt 시작 (여기서는 3부터 시작)
                if (sH.has(s[rt])) sH.set(s[rt], sH.get(s[rt]) + 1);
                else sH.set(s[rt], 1);
                if (compareMaps(sH, tH)) answer++;
                // sH 해시맵에 rt 하나씩 추가하고 tH랑 같은지 비교. (sH.size === tH.size)
                // 같으면 각 Map의 요소들도 동일한지 확인하는 compareMaps 함수 작성.
                // 다 통과하면 answer++.
                sH.set(s[lt], sH.get(s[lt]) - 1);
                if (sH.get(s[lt]) === 0) sH.delete(s[lt]);
                lt++;
                // sH의 lt 요소 key 제거(delete)하고 lt++.
            }
            // 빼고, 추가하고, 비교. 
            return answer;
        }

        let a = "bacaAacba";
        let b = "abc";
        console.log(solution(a, b));
    </script>
</body>

</html>

<html>