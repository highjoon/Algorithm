<html>
    <head>
        <meta charset="UTF-8" />
        <title>신규 아이디 추천</title>
    </head>

    <body>
        <script>
            function solution(new_id) {
                let answer = "";

                // 1단계
                let low = new_id.split("").map((x) => {
                    return x.toLowerCase();
                });

                // 2단계
                let tmp = low.filter((x) => {
                    let asc = x.charCodeAt();
                    if ((asc >= 97 && asc <= 122) || (asc >= 48 && asc <= 57) || asc === 45 || asc === 46 || asc === 95) return x;
                });

                // 3단계
                let stack = [];
                for (let x of tmp) {
                    if (x !== ".") stack.push(x);
                    else {
                        if (stack[stack.length - 1] === ".") continue;
                        else stack.push(x);
                    }
                }
                tmp = stack;

                // 4단계
                if (tmp[0] === ".") tmp.shift();
                if (tmp[tmp.length - 1] === ".") tmp.pop();

                // 5단계
                if (tmp.length === 0) tmp.push("a");

                // 6단계
                if (tmp.length >= 16) {
                    while (tmp.length > 15) {
                        tmp.pop();
                    }
                    if (tmp[tmp.length - 1] === ".") tmp.pop();
                }

                // 7단계
                if (tmp.length <= 2) {
                    let x = tmp[tmp.length - 1];
                    while (tmp.length !== 3) tmp.push(x);
                }

                answer = tmp.join("");
                return answer;
            }

            const n1 = "...!@BaT#*..y.abcdefghijklm";
            const n2 = "z-+.^.";
            const n3 = "=.=";
            const n4 = "123_.def";
            const n5 = "abcdefghijklmn.p";

            console.log(solution(n1));
            console.log(solution(n2));
            console.log(solution(n3));
            console.log(solution(n4));
            console.log(solution(n5));
        </script>
    </body>
</html>
